import axios from "axios";

// Utility function to make API calls
export function callApi(
  url,
  requestType,
  payloadOrCallback,
  paramsOrCallback,
  callback
) {
  let payload = null;
  let params = null;

  // Determine if payload and params are provided or not
  if (typeof payloadOrCallback === "object") {
    payload = payloadOrCallback;
    if (typeof paramsOrCallback === "object") {
      params = paramsOrCallback;
    } else {
      callback = paramsOrCallback;
    }
  } else {
    callback = payloadOrCallback;
  }

  // Get Bearer token from local storage
  const bearerToken = localStorage.getItem("token");

  // Define the Axios request config
  const config = {
    method: requestType,
    url: url,
    data: payload,
    params: params,
    headers: {
      Authorization: `Bearer ${bearerToken}`,
      // Add other headers here if needed
    },
  };

  // Make the API call
  axios(config)
    .then((response) => {
      // Call the callback function with the response data
      callback(response.data);
    })
    .catch((error) => {
      // Handle error
      if (error.response) {
        console.error("API call error status:", error.response.status);
      } else if (error.request) {
        console.error("API call error: No response received");
      } else {
        console.error("API call error:", error.message);
      }
    });
}
